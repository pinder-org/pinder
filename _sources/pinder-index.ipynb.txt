{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "b0000bed-ebd4-4f95-8d63-c87cba8565ac",
   "metadata": {},
   "source": [
    "# Pinder index"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2c23b631-1861-426b-9510-2888cf3aee5b",
   "metadata": {},
   "source": [
    "## Download the dataset\n",
    "\n",
    "NOTE: the default location for the dataset is `~/.local/share/pinder/<release version>`\n",
    "\n",
    "If you want to use a different location, you can do so by setting the `PINDER_BASE_DIR` environment variable.\n",
    "\n",
    "The base dir refers to a fully qualified path name up until the `<release version>` (not inclusive). \n",
    "\n",
    "For instance, you could:\n",
    "```\n",
    "export PINDER_BASE_DIR=~/my-custom-location-for-pinder/pinder\n",
    "```\n",
    "\n",
    "You can always check the current location of the dataset like so:\n",
    "```python\n",
    "from pinder.core import get_pinder_location\n",
    "get_pinder_location()\n",
    "```"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "ecb996d2-2676-4eee-8636-01e26227bdeb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02')"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from pinder.core import get_pinder_location\n",
    "get_pinder_location()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1da603c9-4896-4f4c-be22-b1d79af23808",
   "metadata": {},
   "source": [
    "### To download the complete dataset run the following"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "301ca179-0394-4106-be38-7ddab0caa16d",
   "metadata": {},
   "outputs": [],
   "source": [
    "from pinder.core import download_dataset\n",
    "# download_dataset()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ada695c7-923c-4f58-9e8f-2edd715a31e6",
   "metadata": {},
   "source": [
    "### Alternatively, use the CLI script `pinder_download`\n",
    "\n",
    "```bash\n",
    "pinder_download --help\n",
    "\n",
    "usage: Download latest pinder dataset to disk [-h] [--pinder_base_dir PINDER_BASE_DIR] [--pinder_release PINDER_RELEASE] [--skip_inflation]\n",
    "\n",
    "optional arguments:\n",
    "  -h, --help            show this help message and exit\n",
    "  --pinder_base_dir PINDER_BASE_DIR\n",
    "                        specify a non-default pinder base directory\n",
    "  --pinder_release PINDER_RELEASE\n",
    "                        specify a pinder dataset version\n",
    "  --skip_inflation      if passed, will only download the compressed archives without unpacking\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "31599fbd-5d69-4710-bf42-960ecf2fdc5d",
   "metadata": {},
   "source": [
    "### The full dataset should look like this\n",
    "\n",
    "```bash\n",
    "~/.local/share/pinder/<release version>/\n",
    "    pdbs/\n",
    "    csvs/\n",
    "    index.csv.gz\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b629c20c-5a9f-427c-81ae-e7444b873372",
   "metadata": {},
   "source": [
    "## Pinder metadata API"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "7c5ad9f9-c15b-40c7-bc1b-7a4d24bd9d4e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>entry_id</th>\n",
       "      <th>method</th>\n",
       "      <th>date</th>\n",
       "      <th>release_date</th>\n",
       "      <th>resolution</th>\n",
       "      <th>label</th>\n",
       "      <th>probability</th>\n",
       "      <th>chain1_id</th>\n",
       "      <th>chain2_id</th>\n",
       "      <th>...</th>\n",
       "      <th>interface_atom_gaps_4A</th>\n",
       "      <th>missing_interface_residues_4A</th>\n",
       "      <th>interface_atom_gaps_8A</th>\n",
       "      <th>missing_interface_residues_8A</th>\n",
       "      <th>entity_id_R</th>\n",
       "      <th>entity_id_L</th>\n",
       "      <th>pdb_strand_id_R</th>\n",
       "      <th>pdb_strand_id_L</th>\n",
       "      <th>ECOD_names_R</th>\n",
       "      <th>ECOD_names_L</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>7rzb__A1_A0A229LVN5--7rzb__A2_A0A229LVN5</td>\n",
       "      <td>7rzb</td>\n",
       "      <td>X-RAY DIFFRACTION</td>\n",
       "      <td>2021-08-27</td>\n",
       "      <td>2022-04-13</td>\n",
       "      <td>1.599609</td>\n",
       "      <td>BIO</td>\n",
       "      <td>0.576172</td>\n",
       "      <td>R</td>\n",
       "      <td>L</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>A</td>\n",
       "      <td>A</td>\n",
       "      <td>PF06491</td>\n",
       "      <td>PF06491</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3t2l__A1_Q5LE95--3t2l__A2_Q5LE95</td>\n",
       "      <td>3t2l</td>\n",
       "      <td>X-RAY DIFFRACTION</td>\n",
       "      <td>2011-07-22</td>\n",
       "      <td>2011-08-10</td>\n",
       "      <td>2.330078</td>\n",
       "      <td>BIO</td>\n",
       "      <td>0.983887</td>\n",
       "      <td>R</td>\n",
       "      <td>L</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>A</td>\n",
       "      <td>A</td>\n",
       "      <td>F_UNCLASSIFIED,PF13149</td>\n",
       "      <td>F_UNCLASSIFIED,PF13149</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6ikj__A1_Q9I4L6--6ikj__B1_Q9I4L6</td>\n",
       "      <td>6ikj</td>\n",
       "      <td>X-RAY DIFFRACTION</td>\n",
       "      <td>2018-10-16</td>\n",
       "      <td>2019-03-13</td>\n",
       "      <td>1.759766</td>\n",
       "      <td>BIO</td>\n",
       "      <td>0.543945</td>\n",
       "      <td>R</td>\n",
       "      <td>L</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>A</td>\n",
       "      <td>B</td>\n",
       "      <td>PF00691</td>\n",
       "      <td>PF00691</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>8iyi__A1_Q6CVU4--8iyi__B1_Q6CVU4</td>\n",
       "      <td>8iyi</td>\n",
       "      <td>X-RAY DIFFRACTION</td>\n",
       "      <td>2023-04-05</td>\n",
       "      <td>2023-06-28</td>\n",
       "      <td>1.900391</td>\n",
       "      <td>BIO</td>\n",
       "      <td>0.992188</td>\n",
       "      <td>R</td>\n",
       "      <td>L</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>A</td>\n",
       "      <td>B</td>\n",
       "      <td>PF17284,PF01564</td>\n",
       "      <td>PF17284,PF01564</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3uws__B1_A7A9N3--3uws__A1_A7A9N3</td>\n",
       "      <td>3uws</td>\n",
       "      <td>X-RAY DIFFRACTION</td>\n",
       "      <td>2011-12-02</td>\n",
       "      <td>2012-06-13</td>\n",
       "      <td>1.700195</td>\n",
       "      <td>BIO</td>\n",
       "      <td>0.996094</td>\n",
       "      <td>R</td>\n",
       "      <td>L</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>B</td>\n",
       "      <td>A</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2319559</th>\n",
       "      <td>6hbg__C28_Q8V635--6hbg__C35_Q8V635</td>\n",
       "      <td>6hbg</td>\n",
       "      <td>ELECTRON MICROSCOPY</td>\n",
       "      <td>2018-08-10</td>\n",
       "      <td>2019-03-20</td>\n",
       "      <td>3.160156</td>\n",
       "      <td>BIO</td>\n",
       "      <td>0.512207</td>\n",
       "      <td>R</td>\n",
       "      <td>L</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>C</td>\n",
       "      <td>C</td>\n",
       "      <td>PF00073</td>\n",
       "      <td>PF00073</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2319560</th>\n",
       "      <td>6hbg__A11_Q8V635--6hbg__A54_Q8V635</td>\n",
       "      <td>6hbg</td>\n",
       "      <td>ELECTRON MICROSCOPY</td>\n",
       "      <td>2018-08-10</td>\n",
       "      <td>2019-03-20</td>\n",
       "      <td>3.160156</td>\n",
       "      <td></td>\n",
       "      <td>0.000000</td>\n",
       "      <td>R</td>\n",
       "      <td>L</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>A</td>\n",
       "      <td>A</td>\n",
       "      <td>PF00073</td>\n",
       "      <td>PF00073</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2319561</th>\n",
       "      <td>6hbg__C15_Q8V635--6hbg__D4_Q8V635</td>\n",
       "      <td>6hbg</td>\n",
       "      <td>ELECTRON MICROSCOPY</td>\n",
       "      <td>2018-08-10</td>\n",
       "      <td>2019-03-20</td>\n",
       "      <td>3.160156</td>\n",
       "      <td>XTAL</td>\n",
       "      <td>0.491943</td>\n",
       "      <td>R</td>\n",
       "      <td>L</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>C</td>\n",
       "      <td>D</td>\n",
       "      <td>PF00073</td>\n",
       "      <td>PF02226</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2319562</th>\n",
       "      <td>6hbg__C33_Q8V635--6hbg__D52_Q8V635</td>\n",
       "      <td>6hbg</td>\n",
       "      <td>ELECTRON MICROSCOPY</td>\n",
       "      <td>2018-08-10</td>\n",
       "      <td>2019-03-20</td>\n",
       "      <td>3.160156</td>\n",
       "      <td>XTAL</td>\n",
       "      <td>0.491943</td>\n",
       "      <td>R</td>\n",
       "      <td>L</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>C</td>\n",
       "      <td>D</td>\n",
       "      <td>PF00073</td>\n",
       "      <td>PF02226</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2319563</th>\n",
       "      <td>6rwh__A1_P31947--6rwh__A2_P31947</td>\n",
       "      <td>6rwh</td>\n",
       "      <td>X-RAY DIFFRACTION</td>\n",
       "      <td>2019-06-05</td>\n",
       "      <td>2020-06-17</td>\n",
       "      <td>1.679688</td>\n",
       "      <td>BIO</td>\n",
       "      <td>0.835938</td>\n",
       "      <td>R</td>\n",
       "      <td>L</td>\n",
       "      <td>...</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>64</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>A</td>\n",
       "      <td>A</td>\n",
       "      <td>PF00244</td>\n",
       "      <td>PF00244</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2319564 rows × 51 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                               id entry_id  \\\n",
       "0        7rzb__A1_A0A229LVN5--7rzb__A2_A0A229LVN5     7rzb   \n",
       "1                3t2l__A1_Q5LE95--3t2l__A2_Q5LE95     3t2l   \n",
       "2                6ikj__A1_Q9I4L6--6ikj__B1_Q9I4L6     6ikj   \n",
       "3                8iyi__A1_Q6CVU4--8iyi__B1_Q6CVU4     8iyi   \n",
       "4                3uws__B1_A7A9N3--3uws__A1_A7A9N3     3uws   \n",
       "...                                           ...      ...   \n",
       "2319559        6hbg__C28_Q8V635--6hbg__C35_Q8V635     6hbg   \n",
       "2319560        6hbg__A11_Q8V635--6hbg__A54_Q8V635     6hbg   \n",
       "2319561         6hbg__C15_Q8V635--6hbg__D4_Q8V635     6hbg   \n",
       "2319562        6hbg__C33_Q8V635--6hbg__D52_Q8V635     6hbg   \n",
       "2319563          6rwh__A1_P31947--6rwh__A2_P31947     6rwh   \n",
       "\n",
       "                      method        date release_date  resolution label  \\\n",
       "0          X-RAY DIFFRACTION  2021-08-27   2022-04-13    1.599609   BIO   \n",
       "1          X-RAY DIFFRACTION  2011-07-22   2011-08-10    2.330078   BIO   \n",
       "2          X-RAY DIFFRACTION  2018-10-16   2019-03-13    1.759766   BIO   \n",
       "3          X-RAY DIFFRACTION  2023-04-05   2023-06-28    1.900391   BIO   \n",
       "4          X-RAY DIFFRACTION  2011-12-02   2012-06-13    1.700195   BIO   \n",
       "...                      ...         ...          ...         ...   ...   \n",
       "2319559  ELECTRON MICROSCOPY  2018-08-10   2019-03-20    3.160156   BIO   \n",
       "2319560  ELECTRON MICROSCOPY  2018-08-10   2019-03-20    3.160156         \n",
       "2319561  ELECTRON MICROSCOPY  2018-08-10   2019-03-20    3.160156  XTAL   \n",
       "2319562  ELECTRON MICROSCOPY  2018-08-10   2019-03-20    3.160156  XTAL   \n",
       "2319563    X-RAY DIFFRACTION  2019-06-05   2020-06-17    1.679688   BIO   \n",
       "\n",
       "         probability chain1_id chain2_id  ...  interface_atom_gaps_4A  \\\n",
       "0           0.576172         R         L  ...                       0   \n",
       "1           0.983887         R         L  ...                       0   \n",
       "2           0.543945         R         L  ...                       0   \n",
       "3           0.992188         R         L  ...                       0   \n",
       "4           0.996094         R         L  ...                       0   \n",
       "...              ...       ...       ...  ...                     ...   \n",
       "2319559     0.512207         R         L  ...                       0   \n",
       "2319560     0.000000         R         L  ...                       0   \n",
       "2319561     0.491943         R         L  ...                       0   \n",
       "2319562     0.491943         R         L  ...                       0   \n",
       "2319563     0.835938         R         L  ...                       4   \n",
       "\n",
       "        missing_interface_residues_4A interface_atom_gaps_8A  \\\n",
       "0                                   0                      0   \n",
       "1                                   0                      0   \n",
       "2                                   0                      0   \n",
       "3                                   0                      0   \n",
       "4                                   0                      0   \n",
       "...                               ...                    ...   \n",
       "2319559                             0                      0   \n",
       "2319560                             0                      0   \n",
       "2319561                             0                      0   \n",
       "2319562                             0                      0   \n",
       "2319563                             0                     64   \n",
       "\n",
       "         missing_interface_residues_8A entity_id_R entity_id_L  \\\n",
       "0                                    0           1           1   \n",
       "1                                    0           1           1   \n",
       "2                                    0           1           1   \n",
       "3                                    0           1           1   \n",
       "4                                    0           2           1   \n",
       "...                                ...         ...         ...   \n",
       "2319559                              0           3           3   \n",
       "2319560                              0           1           1   \n",
       "2319561                              0           3           4   \n",
       "2319562                              0           3           4   \n",
       "2319563                              0           1           1   \n",
       "\n",
       "        pdb_strand_id_R pdb_strand_id_L            ECOD_names_R  \\\n",
       "0                     A               A                 PF06491   \n",
       "1                     A               A  F_UNCLASSIFIED,PF13149   \n",
       "2                     A               B                 PF00691   \n",
       "3                     A               B         PF17284,PF01564   \n",
       "4                     B               A                           \n",
       "...                 ...             ...                     ...   \n",
       "2319559               C               C                 PF00073   \n",
       "2319560               A               A                 PF00073   \n",
       "2319561               C               D                 PF00073   \n",
       "2319562               C               D                 PF00073   \n",
       "2319563               A               A                 PF00244   \n",
       "\n",
       "                   ECOD_names_L  \n",
       "0                       PF06491  \n",
       "1        F_UNCLASSIFIED,PF13149  \n",
       "2                       PF00691  \n",
       "3               PF17284,PF01564  \n",
       "4                                \n",
       "...                         ...  \n",
       "2319559                 PF00073  \n",
       "2319560                 PF00073  \n",
       "2319561                 PF02226  \n",
       "2319562                 PF02226  \n",
       "2319563                 PF00244  \n",
       "\n",
       "[2319564 rows x 51 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from pinder.core import get_metadata\n",
    "\n",
    "metadata = get_metadata()\n",
    "metadata\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "00427ee6-105a-4901-b647-52d667cf9eac",
   "metadata": {},
   "source": [
    "## Pinder index API"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "71223020-07c6-4a55-ba37-2343e7b4c400",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>split</th>\n",
       "      <th>id</th>\n",
       "      <th>pdb_id</th>\n",
       "      <th>cluster_id</th>\n",
       "      <th>cluster_id_R</th>\n",
       "      <th>cluster_id_L</th>\n",
       "      <th>pinder_s</th>\n",
       "      <th>pinder_xl</th>\n",
       "      <th>pinder_af2</th>\n",
       "      <th>uniprot_R</th>\n",
       "      <th>...</th>\n",
       "      <th>apo_L</th>\n",
       "      <th>apo_R_quality</th>\n",
       "      <th>apo_L_quality</th>\n",
       "      <th>chain1_neff</th>\n",
       "      <th>chain2_neff</th>\n",
       "      <th>chain_R</th>\n",
       "      <th>chain_L</th>\n",
       "      <th>contains_antibody</th>\n",
       "      <th>contains_antigen</th>\n",
       "      <th>contains_enzyme</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>test</td>\n",
       "      <td>7rzb__A1_A0A229LVN5--7rzb__A2_A0A229LVN5</td>\n",
       "      <td>7rzb</td>\n",
       "      <td>cluster_16129_16129</td>\n",
       "      <td>cluster_16129</td>\n",
       "      <td>cluster_16129</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>A0A229LVN5</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>287.000000</td>\n",
       "      <td>287.000000</td>\n",
       "      <td>A1</td>\n",
       "      <td>A2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>test</td>\n",
       "      <td>3t2l__A1_Q5LE95--3t2l__A2_Q5LE95</td>\n",
       "      <td>3t2l</td>\n",
       "      <td>cluster_30933_30933</td>\n",
       "      <td>cluster_30933</td>\n",
       "      <td>cluster_30933</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>Q5LE95</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>7.175781</td>\n",
       "      <td>7.175781</td>\n",
       "      <td>A1</td>\n",
       "      <td>A2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>test</td>\n",
       "      <td>6ikj__A1_Q9I4L6--6ikj__B1_Q9I4L6</td>\n",
       "      <td>6ikj</td>\n",
       "      <td>cluster_1924_1924</td>\n",
       "      <td>cluster_1924</td>\n",
       "      <td>cluster_1924</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>Q9I4L6</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>845.000000</td>\n",
       "      <td>845.000000</td>\n",
       "      <td>A1</td>\n",
       "      <td>B1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>test</td>\n",
       "      <td>8iyi__A1_Q6CVU4--8iyi__B1_Q6CVU4</td>\n",
       "      <td>8iyi</td>\n",
       "      <td>cluster_142_142</td>\n",
       "      <td>cluster_142</td>\n",
       "      <td>cluster_142</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>Q6CVU4</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>525.000000</td>\n",
       "      <td>525.000000</td>\n",
       "      <td>A1</td>\n",
       "      <td>B1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>test</td>\n",
       "      <td>3uws__B1_A7A9N3--3uws__A1_A7A9N3</td>\n",
       "      <td>3uws</td>\n",
       "      <td>cluster_21030_21031</td>\n",
       "      <td>cluster_21030</td>\n",
       "      <td>cluster_21031</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>A7A9N3</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>147.375000</td>\n",
       "      <td>147.375000</td>\n",
       "      <td>B1</td>\n",
       "      <td>A1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2319559</th>\n",
       "      <td>invalid</td>\n",
       "      <td>6hbg__C28_Q8V635--6hbg__C35_Q8V635</td>\n",
       "      <td>6hbg</td>\n",
       "      <td>cluster_-1_-1</td>\n",
       "      <td>cluster_-1</td>\n",
       "      <td>cluster_-1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>Q8V635</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>37.656250</td>\n",
       "      <td>37.656250</td>\n",
       "      <td>C28</td>\n",
       "      <td>C35</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2319560</th>\n",
       "      <td>invalid</td>\n",
       "      <td>6hbg__A11_Q8V635--6hbg__A54_Q8V635</td>\n",
       "      <td>6hbg</td>\n",
       "      <td>cluster_-1_-1</td>\n",
       "      <td>cluster_-1</td>\n",
       "      <td>cluster_-1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>Q8V635</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>37.656250</td>\n",
       "      <td>37.656250</td>\n",
       "      <td>A11</td>\n",
       "      <td>A54</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2319561</th>\n",
       "      <td>invalid</td>\n",
       "      <td>6hbg__C15_Q8V635--6hbg__D4_Q8V635</td>\n",
       "      <td>6hbg</td>\n",
       "      <td>cluster_-1_p</td>\n",
       "      <td>cluster_p</td>\n",
       "      <td>cluster_-1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>Q8V635</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>37.656250</td>\n",
       "      <td>37.656250</td>\n",
       "      <td>C15</td>\n",
       "      <td>D4</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2319562</th>\n",
       "      <td>invalid</td>\n",
       "      <td>6hbg__C33_Q8V635--6hbg__D52_Q8V635</td>\n",
       "      <td>6hbg</td>\n",
       "      <td>cluster_-1_p</td>\n",
       "      <td>cluster_p</td>\n",
       "      <td>cluster_-1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>Q8V635</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>37.656250</td>\n",
       "      <td>37.656250</td>\n",
       "      <td>C33</td>\n",
       "      <td>D52</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2319563</th>\n",
       "      <td>invalid</td>\n",
       "      <td>6rwh__A1_P31947--6rwh__A2_P31947</td>\n",
       "      <td>6rwh</td>\n",
       "      <td>cluster_2_2</td>\n",
       "      <td>cluster_2</td>\n",
       "      <td>cluster_2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>P31947</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>457.750000</td>\n",
       "      <td>457.750000</td>\n",
       "      <td>A1</td>\n",
       "      <td>A2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2319564 rows × 34 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           split                                        id pdb_id  \\\n",
       "0           test  7rzb__A1_A0A229LVN5--7rzb__A2_A0A229LVN5   7rzb   \n",
       "1           test          3t2l__A1_Q5LE95--3t2l__A2_Q5LE95   3t2l   \n",
       "2           test          6ikj__A1_Q9I4L6--6ikj__B1_Q9I4L6   6ikj   \n",
       "3           test          8iyi__A1_Q6CVU4--8iyi__B1_Q6CVU4   8iyi   \n",
       "4           test          3uws__B1_A7A9N3--3uws__A1_A7A9N3   3uws   \n",
       "...          ...                                       ...    ...   \n",
       "2319559  invalid        6hbg__C28_Q8V635--6hbg__C35_Q8V635   6hbg   \n",
       "2319560  invalid        6hbg__A11_Q8V635--6hbg__A54_Q8V635   6hbg   \n",
       "2319561  invalid         6hbg__C15_Q8V635--6hbg__D4_Q8V635   6hbg   \n",
       "2319562  invalid        6hbg__C33_Q8V635--6hbg__D52_Q8V635   6hbg   \n",
       "2319563  invalid          6rwh__A1_P31947--6rwh__A2_P31947   6rwh   \n",
       "\n",
       "                  cluster_id   cluster_id_R   cluster_id_L  pinder_s  \\\n",
       "0        cluster_16129_16129  cluster_16129  cluster_16129     False   \n",
       "1        cluster_30933_30933  cluster_30933  cluster_30933     False   \n",
       "2          cluster_1924_1924   cluster_1924   cluster_1924     False   \n",
       "3            cluster_142_142    cluster_142    cluster_142     False   \n",
       "4        cluster_21030_21031  cluster_21030  cluster_21031     False   \n",
       "...                      ...            ...            ...       ...   \n",
       "2319559        cluster_-1_-1     cluster_-1     cluster_-1     False   \n",
       "2319560        cluster_-1_-1     cluster_-1     cluster_-1     False   \n",
       "2319561         cluster_-1_p      cluster_p     cluster_-1     False   \n",
       "2319562         cluster_-1_p      cluster_p     cluster_-1     False   \n",
       "2319563          cluster_2_2      cluster_2      cluster_2     False   \n",
       "\n",
       "         pinder_xl  pinder_af2   uniprot_R  ...  apo_L apo_R_quality  \\\n",
       "0             True        True  A0A229LVN5  ...  False                 \n",
       "1             True       False      Q5LE95  ...  False                 \n",
       "2             True       False      Q9I4L6  ...   True          high   \n",
       "3             True       False      Q6CVU4  ...  False                 \n",
       "4             True       False      A7A9N3  ...  False                 \n",
       "...            ...         ...         ...  ...    ...           ...   \n",
       "2319559      False       False      Q8V635  ...  False                 \n",
       "2319560      False       False      Q8V635  ...  False                 \n",
       "2319561      False       False      Q8V635  ...  False                 \n",
       "2319562      False       False      Q8V635  ...  False                 \n",
       "2319563      False       False      P31947  ...  False                 \n",
       "\n",
       "        apo_L_quality chain1_neff chain2_neff chain_R chain_L  \\\n",
       "0                      287.000000  287.000000      A1      A2   \n",
       "1                        7.175781    7.175781      A1      A2   \n",
       "2                high  845.000000  845.000000      A1      B1   \n",
       "3                      525.000000  525.000000      A1      B1   \n",
       "4                      147.375000  147.375000      B1      A1   \n",
       "...               ...         ...         ...     ...     ...   \n",
       "2319559                 37.656250   37.656250     C28     C35   \n",
       "2319560                 37.656250   37.656250     A11     A54   \n",
       "2319561                 37.656250   37.656250     C15      D4   \n",
       "2319562                 37.656250   37.656250     C33     D52   \n",
       "2319563                457.750000  457.750000      A1      A2   \n",
       "\n",
       "        contains_antibody contains_antigen  contains_enzyme  \n",
       "0                   False            False            False  \n",
       "1                   False            False            False  \n",
       "2                   False            False            False  \n",
       "3                   False            False            False  \n",
       "4                   False            False            False  \n",
       "...                   ...              ...              ...  \n",
       "2319559             False            False             True  \n",
       "2319560             False            False             True  \n",
       "2319561             False            False             True  \n",
       "2319562             False            False             True  \n",
       "2319563             False            False            False  \n",
       "\n",
       "[2319564 rows x 34 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from pinder.core import PinderSystem, get_index\n",
    "\n",
    "index = get_index()\n",
    "index"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "58385b67-74dd-427b-9ff5-8d7e09ae0bc9",
   "metadata": {},
   "source": [
    "### How to get subsets of data from the index "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "67fb0b80-6e3e-4b33-82c6-ff4364b45cde",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>split</th>\n",
       "      <th>id</th>\n",
       "      <th>pdb_id</th>\n",
       "      <th>cluster_id</th>\n",
       "      <th>cluster_id_R</th>\n",
       "      <th>cluster_id_L</th>\n",
       "      <th>pinder_s</th>\n",
       "      <th>pinder_xl</th>\n",
       "      <th>pinder_af2</th>\n",
       "      <th>uniprot_R</th>\n",
       "      <th>...</th>\n",
       "      <th>apo_L</th>\n",
       "      <th>apo_R_quality</th>\n",
       "      <th>apo_L_quality</th>\n",
       "      <th>chain1_neff</th>\n",
       "      <th>chain2_neff</th>\n",
       "      <th>chain_R</th>\n",
       "      <th>chain_L</th>\n",
       "      <th>contains_antibody</th>\n",
       "      <th>contains_antigen</th>\n",
       "      <th>contains_enzyme</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>test</td>\n",
       "      <td>7ubk__B1_P03047--7ubk__A1_P03047</td>\n",
       "      <td>7ubk</td>\n",
       "      <td>cluster_31523_31523</td>\n",
       "      <td>cluster_31523</td>\n",
       "      <td>cluster_31523</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>P03047</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>81.750000</td>\n",
       "      <td>81.750000</td>\n",
       "      <td>B1</td>\n",
       "      <td>A1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>test</td>\n",
       "      <td>7zj1__B1_P55265--7zj1__A1_P55265</td>\n",
       "      <td>7zj1</td>\n",
       "      <td>cluster_1209_1209</td>\n",
       "      <td>cluster_1209</td>\n",
       "      <td>cluster_1209</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>P55265</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>174.250000</td>\n",
       "      <td>174.250000</td>\n",
       "      <td>B1</td>\n",
       "      <td>A1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>test</td>\n",
       "      <td>7zjc__A1_P0DV83--7zjc__A2_P0DV83</td>\n",
       "      <td>7zjc</td>\n",
       "      <td>cluster_26441_26441</td>\n",
       "      <td>cluster_26441</td>\n",
       "      <td>cluster_26441</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>P0DV83</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>6.925781</td>\n",
       "      <td>6.925781</td>\n",
       "      <td>A1</td>\n",
       "      <td>A2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>test</td>\n",
       "      <td>7ztw__A1_Q66578--7ztw__B1_Q66578</td>\n",
       "      <td>7ztw</td>\n",
       "      <td>cluster_22347_22347</td>\n",
       "      <td>cluster_22347</td>\n",
       "      <td>cluster_22347</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Q66578</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>13.382812</td>\n",
       "      <td>13.382812</td>\n",
       "      <td>A1</td>\n",
       "      <td>B1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>test</td>\n",
       "      <td>8ard__A1_Q64331--8ard__A2_Q64331</td>\n",
       "      <td>8ard</td>\n",
       "      <td>cluster_34280_34280</td>\n",
       "      <td>cluster_34280</td>\n",
       "      <td>cluster_34280</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Q64331</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>444.750000</td>\n",
       "      <td>444.750000</td>\n",
       "      <td>A1</td>\n",
       "      <td>A2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>test</td>\n",
       "      <td>7wbt__A1_Q288C4--7wbt__B1_Q288C4</td>\n",
       "      <td>7wbt</td>\n",
       "      <td>cluster_7371_7371</td>\n",
       "      <td>cluster_7371</td>\n",
       "      <td>cluster_7371</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Q288C4</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>169.500000</td>\n",
       "      <td>169.500000</td>\n",
       "      <td>A1</td>\n",
       "      <td>B1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>test</td>\n",
       "      <td>7z7o__A1_A0A1S4NYF2--7z7o__C1_A0A1S4NYF2</td>\n",
       "      <td>7z7o</td>\n",
       "      <td>cluster_91_91</td>\n",
       "      <td>cluster_91</td>\n",
       "      <td>cluster_91</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>A0A1S4NYF2</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>10.632812</td>\n",
       "      <td>10.632812</td>\n",
       "      <td>A1</td>\n",
       "      <td>C1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>test</td>\n",
       "      <td>8pte__A1_P00698--8pte__A2_P00698</td>\n",
       "      <td>8pte</td>\n",
       "      <td>cluster_274_274</td>\n",
       "      <td>cluster_274</td>\n",
       "      <td>cluster_274</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>P00698</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>254.375000</td>\n",
       "      <td>254.375000</td>\n",
       "      <td>A1</td>\n",
       "      <td>A2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>test</td>\n",
       "      <td>7yka__B1_Q9Y3D6--7yka__A1_Q9Y3D6</td>\n",
       "      <td>7yka</td>\n",
       "      <td>cluster_13298_13298</td>\n",
       "      <td>cluster_13298</td>\n",
       "      <td>cluster_13298</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Q9Y3D6</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>132.875000</td>\n",
       "      <td>132.875000</td>\n",
       "      <td>B1</td>\n",
       "      <td>A1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>test</td>\n",
       "      <td>7ykv__B1_Q58241--7ykv__A1_Q58241</td>\n",
       "      <td>7ykv</td>\n",
       "      <td>cluster_5358_5358</td>\n",
       "      <td>cluster_5358</td>\n",
       "      <td>cluster_5358</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Q58241</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>171.625000</td>\n",
       "      <td>171.625000</td>\n",
       "      <td>B1</td>\n",
       "      <td>A1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>test</td>\n",
       "      <td>8a60__A1_P06971--8a60__B1_Q38162</td>\n",
       "      <td>8a60</td>\n",
       "      <td>cluster_12107_26846</td>\n",
       "      <td>cluster_12107</td>\n",
       "      <td>cluster_26846</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>P06971</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>288.000000</td>\n",
       "      <td>2.734375</td>\n",
       "      <td>A1</td>\n",
       "      <td>B1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>test</td>\n",
       "      <td>7t5y__A1_P0A7E1--7t5y__B1_P0A7E1</td>\n",
       "      <td>7t5y</td>\n",
       "      <td>cluster_7939_7939</td>\n",
       "      <td>cluster_7939</td>\n",
       "      <td>cluster_7939</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>P0A7E1</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>735.500000</td>\n",
       "      <td>735.500000</td>\n",
       "      <td>A1</td>\n",
       "      <td>B1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>test</td>\n",
       "      <td>8oru__A1_O93732--8oru__B1_O93732</td>\n",
       "      <td>8oru</td>\n",
       "      <td>cluster_14951_14951</td>\n",
       "      <td>cluster_14951</td>\n",
       "      <td>cluster_14951</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>O93732</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>103.187500</td>\n",
       "      <td>103.187500</td>\n",
       "      <td>A1</td>\n",
       "      <td>B1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>test</td>\n",
       "      <td>7z6m__A1_A0A0H3LM39--7z6m__A2_A0A0H3LM39</td>\n",
       "      <td>7z6m</td>\n",
       "      <td>cluster_5362_5362</td>\n",
       "      <td>cluster_5362</td>\n",
       "      <td>cluster_5362</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>A0A0H3LM39</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>533.000000</td>\n",
       "      <td>533.000000</td>\n",
       "      <td>A1</td>\n",
       "      <td>A2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>test</td>\n",
       "      <td>8cnx__A1_Q68T42--8cnx__B1_Q68T42</td>\n",
       "      <td>8cnx</td>\n",
       "      <td>cluster_609_609</td>\n",
       "      <td>cluster_609</td>\n",
       "      <td>cluster_609</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Q68T42</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>45.000000</td>\n",
       "      <td>45.000000</td>\n",
       "      <td>A1</td>\n",
       "      <td>B1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>test</td>\n",
       "      <td>7wwo__B1_Q5SH57--7wwo__A1_Q5SH57</td>\n",
       "      <td>7wwo</td>\n",
       "      <td>cluster_5115_5115</td>\n",
       "      <td>cluster_5115</td>\n",
       "      <td>cluster_5115</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Q5SH57</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>2.939453</td>\n",
       "      <td>2.939453</td>\n",
       "      <td>B1</td>\n",
       "      <td>A1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>test</td>\n",
       "      <td>8d0m__A1_P28907--8d0m__A2_P28907</td>\n",
       "      <td>8d0m</td>\n",
       "      <td>cluster_2975_2975</td>\n",
       "      <td>cluster_2975</td>\n",
       "      <td>cluster_2975</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>P28907</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>48.312500</td>\n",
       "      <td>48.312500</td>\n",
       "      <td>A1</td>\n",
       "      <td>A2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>test</td>\n",
       "      <td>8avu__A1_Q8GPI4--8avu__A2_Q8GPI4</td>\n",
       "      <td>8avu</td>\n",
       "      <td>cluster_29712_29712</td>\n",
       "      <td>cluster_29712</td>\n",
       "      <td>cluster_29712</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Q8GPI4</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>11.882812</td>\n",
       "      <td>11.882812</td>\n",
       "      <td>A1</td>\n",
       "      <td>A2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>test</td>\n",
       "      <td>8i2e__A1_O34841--8i2e__B1_P54421</td>\n",
       "      <td>8i2e</td>\n",
       "      <td>cluster_11087_12465</td>\n",
       "      <td>cluster_12465</td>\n",
       "      <td>cluster_11087</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>O34841</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>9.031250</td>\n",
       "      <td>865.000000</td>\n",
       "      <td>A1</td>\n",
       "      <td>B1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>test</td>\n",
       "      <td>8aeu__A1_Q00987--8aeu__A2_Q00987</td>\n",
       "      <td>8aeu</td>\n",
       "      <td>cluster_1537_1537</td>\n",
       "      <td>cluster_1537</td>\n",
       "      <td>cluster_1537</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Q00987</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>350.750000</td>\n",
       "      <td>350.750000</td>\n",
       "      <td>A1</td>\n",
       "      <td>A2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>test</td>\n",
       "      <td>7vso__A1_P02945--7vso__A2_P02945</td>\n",
       "      <td>7vso</td>\n",
       "      <td>cluster_1035_1035</td>\n",
       "      <td>cluster_1035</td>\n",
       "      <td>cluster_1035</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>P02945</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>267.250000</td>\n",
       "      <td>267.250000</td>\n",
       "      <td>A1</td>\n",
       "      <td>A2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>test</td>\n",
       "      <td>7yuj__B1_Q9BYM8--7yuj__A1_Q9BYM8</td>\n",
       "      <td>7yuj</td>\n",
       "      <td>cluster_19439_19439</td>\n",
       "      <td>cluster_19439</td>\n",
       "      <td>cluster_19439</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Q9BYM8</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>266.750000</td>\n",
       "      <td>266.750000</td>\n",
       "      <td>B1</td>\n",
       "      <td>A1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>test</td>\n",
       "      <td>8pvm__A1_P29166--8pvm__B1_P29166</td>\n",
       "      <td>8pvm</td>\n",
       "      <td>cluster_6440_6440</td>\n",
       "      <td>cluster_6440</td>\n",
       "      <td>cluster_6440</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>P29166</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>392.500000</td>\n",
       "      <td>392.500000</td>\n",
       "      <td>A1</td>\n",
       "      <td>B1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>test</td>\n",
       "      <td>7yo8__A1_P60520--7yo8__A2_P60520</td>\n",
       "      <td>7yo8</td>\n",
       "      <td>cluster_1022_1022</td>\n",
       "      <td>cluster_1022</td>\n",
       "      <td>cluster_1022</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>P60520</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>385.500000</td>\n",
       "      <td>385.500000</td>\n",
       "      <td>A1</td>\n",
       "      <td>A2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>test</td>\n",
       "      <td>7y51__A1_Q8RBF4--7y51__A2_Q8RBF4</td>\n",
       "      <td>7y51</td>\n",
       "      <td>cluster_711_711</td>\n",
       "      <td>cluster_711</td>\n",
       "      <td>cluster_711</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Q8RBF4</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>954.500000</td>\n",
       "      <td>954.500000</td>\n",
       "      <td>A1</td>\n",
       "      <td>A2</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>test</td>\n",
       "      <td>7tvh__B1_Q9I2Q1--7tvh__A1_Q9I2Q1</td>\n",
       "      <td>7tvh</td>\n",
       "      <td>cluster_8106_8106</td>\n",
       "      <td>cluster_8106</td>\n",
       "      <td>cluster_8106</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Q9I2Q1</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>209.125000</td>\n",
       "      <td>209.125000</td>\n",
       "      <td>B1</td>\n",
       "      <td>A1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>test</td>\n",
       "      <td>8bwv__D2_A0A482M8M0--8bwv__A1_A0A482M8M0</td>\n",
       "      <td>8bwv</td>\n",
       "      <td>cluster_27613_27613</td>\n",
       "      <td>cluster_27613</td>\n",
       "      <td>cluster_27613</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>A0A482M8M0</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>395.000000</td>\n",
       "      <td>395.000000</td>\n",
       "      <td>D2</td>\n",
       "      <td>A1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>test</td>\n",
       "      <td>7t91__A1_P08151--7t91__B1_P08151</td>\n",
       "      <td>7t91</td>\n",
       "      <td>cluster_1801_1801</td>\n",
       "      <td>cluster_1801</td>\n",
       "      <td>cluster_1801</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>P08151</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>321.250000</td>\n",
       "      <td>321.250000</td>\n",
       "      <td>A1</td>\n",
       "      <td>B1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>test</td>\n",
       "      <td>7zoo__B1_A0A979GQH9--7zoo__A1_A0A979GQH9</td>\n",
       "      <td>7zoo</td>\n",
       "      <td>cluster_32633_32633</td>\n",
       "      <td>cluster_32633</td>\n",
       "      <td>cluster_32633</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>A0A979GQH9</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>419.250000</td>\n",
       "      <td>419.250000</td>\n",
       "      <td>B1</td>\n",
       "      <td>A1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>test</td>\n",
       "      <td>7x4b__A1_A0A2D0TCG3--7x4b__B1_A0A2D0TCG3</td>\n",
       "      <td>7x4b</td>\n",
       "      <td>cluster_7334_7334</td>\n",
       "      <td>cluster_7334</td>\n",
       "      <td>cluster_7334</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>A0A2D0TCG3</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>high</td>\n",
       "      <td>high</td>\n",
       "      <td>9.453125</td>\n",
       "      <td>9.453125</td>\n",
       "      <td>A1</td>\n",
       "      <td>B1</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>30 rows × 34 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   split                                        id pdb_id  \\\n",
       "0   test          7ubk__B1_P03047--7ubk__A1_P03047   7ubk   \n",
       "1   test          7zj1__B1_P55265--7zj1__A1_P55265   7zj1   \n",
       "2   test          7zjc__A1_P0DV83--7zjc__A2_P0DV83   7zjc   \n",
       "3   test          7ztw__A1_Q66578--7ztw__B1_Q66578   7ztw   \n",
       "4   test          8ard__A1_Q64331--8ard__A2_Q64331   8ard   \n",
       "5   test          7wbt__A1_Q288C4--7wbt__B1_Q288C4   7wbt   \n",
       "6   test  7z7o__A1_A0A1S4NYF2--7z7o__C1_A0A1S4NYF2   7z7o   \n",
       "7   test          8pte__A1_P00698--8pte__A2_P00698   8pte   \n",
       "8   test          7yka__B1_Q9Y3D6--7yka__A1_Q9Y3D6   7yka   \n",
       "9   test          7ykv__B1_Q58241--7ykv__A1_Q58241   7ykv   \n",
       "10  test          8a60__A1_P06971--8a60__B1_Q38162   8a60   \n",
       "11  test          7t5y__A1_P0A7E1--7t5y__B1_P0A7E1   7t5y   \n",
       "12  test          8oru__A1_O93732--8oru__B1_O93732   8oru   \n",
       "13  test  7z6m__A1_A0A0H3LM39--7z6m__A2_A0A0H3LM39   7z6m   \n",
       "14  test          8cnx__A1_Q68T42--8cnx__B1_Q68T42   8cnx   \n",
       "15  test          7wwo__B1_Q5SH57--7wwo__A1_Q5SH57   7wwo   \n",
       "16  test          8d0m__A1_P28907--8d0m__A2_P28907   8d0m   \n",
       "17  test          8avu__A1_Q8GPI4--8avu__A2_Q8GPI4   8avu   \n",
       "18  test          8i2e__A1_O34841--8i2e__B1_P54421   8i2e   \n",
       "19  test          8aeu__A1_Q00987--8aeu__A2_Q00987   8aeu   \n",
       "20  test          7vso__A1_P02945--7vso__A2_P02945   7vso   \n",
       "21  test          7yuj__B1_Q9BYM8--7yuj__A1_Q9BYM8   7yuj   \n",
       "22  test          8pvm__A1_P29166--8pvm__B1_P29166   8pvm   \n",
       "23  test          7yo8__A1_P60520--7yo8__A2_P60520   7yo8   \n",
       "24  test          7y51__A1_Q8RBF4--7y51__A2_Q8RBF4   7y51   \n",
       "25  test          7tvh__B1_Q9I2Q1--7tvh__A1_Q9I2Q1   7tvh   \n",
       "26  test  8bwv__D2_A0A482M8M0--8bwv__A1_A0A482M8M0   8bwv   \n",
       "27  test          7t91__A1_P08151--7t91__B1_P08151   7t91   \n",
       "28  test  7zoo__B1_A0A979GQH9--7zoo__A1_A0A979GQH9   7zoo   \n",
       "29  test  7x4b__A1_A0A2D0TCG3--7x4b__B1_A0A2D0TCG3   7x4b   \n",
       "\n",
       "             cluster_id   cluster_id_R   cluster_id_L  pinder_s  pinder_xl  \\\n",
       "0   cluster_31523_31523  cluster_31523  cluster_31523     False       True   \n",
       "1     cluster_1209_1209   cluster_1209   cluster_1209     False       True   \n",
       "2   cluster_26441_26441  cluster_26441  cluster_26441     False       True   \n",
       "3   cluster_22347_22347  cluster_22347  cluster_22347     False       True   \n",
       "4   cluster_34280_34280  cluster_34280  cluster_34280     False       True   \n",
       "5     cluster_7371_7371   cluster_7371   cluster_7371      True       True   \n",
       "6         cluster_91_91     cluster_91     cluster_91     False       True   \n",
       "7       cluster_274_274    cluster_274    cluster_274     False       True   \n",
       "8   cluster_13298_13298  cluster_13298  cluster_13298     False       True   \n",
       "9     cluster_5358_5358   cluster_5358   cluster_5358     False       True   \n",
       "10  cluster_12107_26846  cluster_12107  cluster_26846     False       True   \n",
       "11    cluster_7939_7939   cluster_7939   cluster_7939     False       True   \n",
       "12  cluster_14951_14951  cluster_14951  cluster_14951     False       True   \n",
       "13    cluster_5362_5362   cluster_5362   cluster_5362     False       True   \n",
       "14      cluster_609_609    cluster_609    cluster_609     False       True   \n",
       "15    cluster_5115_5115   cluster_5115   cluster_5115     False       True   \n",
       "16    cluster_2975_2975   cluster_2975   cluster_2975      True       True   \n",
       "17  cluster_29712_29712  cluster_29712  cluster_29712     False       True   \n",
       "18  cluster_11087_12465  cluster_12465  cluster_11087      True       True   \n",
       "19    cluster_1537_1537   cluster_1537   cluster_1537     False       True   \n",
       "20    cluster_1035_1035   cluster_1035   cluster_1035     False       True   \n",
       "21  cluster_19439_19439  cluster_19439  cluster_19439      True       True   \n",
       "22    cluster_6440_6440   cluster_6440   cluster_6440     False       True   \n",
       "23    cluster_1022_1022   cluster_1022   cluster_1022     False       True   \n",
       "24      cluster_711_711    cluster_711    cluster_711     False       True   \n",
       "25    cluster_8106_8106   cluster_8106   cluster_8106     False       True   \n",
       "26  cluster_27613_27613  cluster_27613  cluster_27613     False       True   \n",
       "27    cluster_1801_1801   cluster_1801   cluster_1801     False       True   \n",
       "28  cluster_32633_32633  cluster_32633  cluster_32633     False       True   \n",
       "29    cluster_7334_7334   cluster_7334   cluster_7334     False       True   \n",
       "\n",
       "    pinder_af2   uniprot_R  ... apo_L apo_R_quality apo_L_quality chain1_neff  \\\n",
       "0         True      P03047  ...  True          high          high   81.750000   \n",
       "1         True      P55265  ...  True          high          high  174.250000   \n",
       "2         True      P0DV83  ...  True          high          high    6.925781   \n",
       "3         True      Q66578  ...  True          high          high   13.382812   \n",
       "4         True      Q64331  ...  True          high          high  444.750000   \n",
       "5         True      Q288C4  ...  True          high          high  169.500000   \n",
       "6         True  A0A1S4NYF2  ...  True          high          high   10.632812   \n",
       "7         True      P00698  ...  True          high          high  254.375000   \n",
       "8         True      Q9Y3D6  ...  True          high          high  132.875000   \n",
       "9         True      Q58241  ...  True          high          high  171.625000   \n",
       "10        True      P06971  ...  True          high          high  288.000000   \n",
       "11        True      P0A7E1  ...  True          high          high  735.500000   \n",
       "12        True      O93732  ...  True          high          high  103.187500   \n",
       "13        True  A0A0H3LM39  ...  True          high          high  533.000000   \n",
       "14        True      Q68T42  ...  True          high          high   45.000000   \n",
       "15        True      Q5SH57  ...  True          high          high    2.939453   \n",
       "16        True      P28907  ...  True          high          high   48.312500   \n",
       "17        True      Q8GPI4  ...  True          high          high   11.882812   \n",
       "18        True      O34841  ...  True          high          high    9.031250   \n",
       "19        True      Q00987  ...  True          high          high  350.750000   \n",
       "20        True      P02945  ...  True          high          high  267.250000   \n",
       "21        True      Q9BYM8  ...  True          high          high  266.750000   \n",
       "22        True      P29166  ...  True          high          high  392.500000   \n",
       "23        True      P60520  ...  True          high          high  385.500000   \n",
       "24        True      Q8RBF4  ...  True          high          high  954.500000   \n",
       "25        True      Q9I2Q1  ...  True          high          high  209.125000   \n",
       "26        True  A0A482M8M0  ...  True          high          high  395.000000   \n",
       "27        True      P08151  ...  True          high          high  321.250000   \n",
       "28        True  A0A979GQH9  ...  True          high          high  419.250000   \n",
       "29        True  A0A2D0TCG3  ...  True          high          high    9.453125   \n",
       "\n",
       "   chain2_neff chain_R chain_L contains_antibody contains_antigen  \\\n",
       "0    81.750000      B1      A1             False            False   \n",
       "1   174.250000      B1      A1             False            False   \n",
       "2     6.925781      A1      A2             False            False   \n",
       "3    13.382812      A1      B1             False            False   \n",
       "4   444.750000      A1      A2             False            False   \n",
       "5   169.500000      A1      B1             False            False   \n",
       "6    10.632812      A1      C1             False            False   \n",
       "7   254.375000      A1      A2             False            False   \n",
       "8   132.875000      B1      A1             False            False   \n",
       "9   171.625000      B1      A1             False            False   \n",
       "10    2.734375      A1      B1             False            False   \n",
       "11  735.500000      A1      B1             False            False   \n",
       "12  103.187500      A1      B1             False            False   \n",
       "13  533.000000      A1      A2             False            False   \n",
       "14   45.000000      A1      B1             False            False   \n",
       "15    2.939453      B1      A1             False            False   \n",
       "16   48.312500      A1      A2             False            False   \n",
       "17   11.882812      A1      A2             False            False   \n",
       "18  865.000000      A1      B1             False            False   \n",
       "19  350.750000      A1      A2             False            False   \n",
       "20  267.250000      A1      A2             False            False   \n",
       "21  266.750000      B1      A1             False            False   \n",
       "22  392.500000      A1      B1             False            False   \n",
       "23  385.500000      A1      A2             False            False   \n",
       "24  954.500000      A1      A2             False            False   \n",
       "25  209.125000      B1      A1             False            False   \n",
       "26  395.000000      D2      A1             False            False   \n",
       "27  321.250000      A1      B1             False            False   \n",
       "28  419.250000      B1      A1             False            False   \n",
       "29    9.453125      A1      B1             False            False   \n",
       "\n",
       "    contains_enzyme  \n",
       "0             False  \n",
       "1              True  \n",
       "2             False  \n",
       "3             False  \n",
       "4             False  \n",
       "5             False  \n",
       "6             False  \n",
       "7              True  \n",
       "8             False  \n",
       "9             False  \n",
       "10            False  \n",
       "11             True  \n",
       "12             True  \n",
       "13            False  \n",
       "14             True  \n",
       "15            False  \n",
       "16             True  \n",
       "17            False  \n",
       "18             True  \n",
       "19             True  \n",
       "20            False  \n",
       "21             True  \n",
       "22             True  \n",
       "23            False  \n",
       "24            False  \n",
       "25             True  \n",
       "26            False  \n",
       "27            False  \n",
       "28            False  \n",
       "29            False  \n",
       "\n",
       "[30 rows x 34 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Example: I want all of pinder_af2 - apo\n",
    "\n",
    "af2_apo = index.query(\n",
    "    'pinder_af2 == True and apo_R and apo_L'\n",
    ").reset_index(drop=True)\n",
    "af2_apo\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6b19ee41-8e9e-4657-8f39-77fdfc42becb",
   "metadata": {},
   "source": [
    "### Finding the existing local filepaths for systems (without re-writing them per system)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "aa97b738-8a64-4e43-b1dc-17b226c470fb",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "  0%|                                                                                                                                                                                                               | 0/30 [00:00<?, ?it/s]2024-06-20 10:52:38,123 | pinder.core.utils.cloud:368 | INFO : Gsutil process_many=download_to_filename, threads=2, items=2\n",
      "2024-06-20 10:52:38,420 | pinder.core.utils.cloud.process_many:27 | ERROR : runtime failed:      0.30s\n",
      "2024-06-20 10:52:38,421 | pinder.core.loader.loader:35 | ERROR : Requested storage blob <2024-02/pdbs/af__P03047.pdb> does not exist! Verify that the provided GCS path points to a valid file!\n",
      " 43%|█████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                | 13/30 [00:03<00:03,  5.51it/s]2024-06-20 10:52:40,671 | pinder.core.utils.cloud:368 | INFO : Gsutil process_many=download_to_filename, threads=2, items=2\n",
      "2024-06-20 10:52:40,837 | pinder.core.utils.cloud.process_many:27 | ERROR : runtime failed:      0.17s\n",
      "2024-06-20 10:52:40,838 | pinder.core.loader.loader:35 | ERROR : Requested storage blob <2024-02/pdbs/af__Q68T42.pdb> does not exist! Verify that the provided GCS path points to a valid file!\n",
      "100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:04<00:00,  6.25it/s]\n"
     ]
    }
   ],
   "source": [
    "from pinder.core import get_systems\n",
    "\n",
    "\n",
    "local_paths = {}\n",
    "for system in get_systems(list(af2_apo.id)):\n",
    "    local_paths[system.entry.id] = system.filepaths\n",
    "    "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5e2c7ce8-f9a6-4cf1-80bf-ebcab410baf1",
   "metadata": {},
   "source": [
    "### It should be cached, no need to download if you re-run"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "7ade9b56-8489-43de-9554-18229a0651c7",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "  0%|                                                                                                                                                                                                               | 0/30 [00:00<?, ?it/s]2024-06-20 10:52:42,266 | pinder.core.utils.cloud:368 | INFO : Gsutil process_many=download_to_filename, threads=2, items=2\n",
      "2024-06-20 10:52:42,364 | pinder.core.utils.cloud.process_many:27 | ERROR : runtime failed:      0.10s\n",
      "2024-06-20 10:52:42,364 | pinder.core.loader.loader:35 | ERROR : Requested storage blob <2024-02/pdbs/af__P03047.pdb> does not exist! Verify that the provided GCS path points to a valid file!\n",
      " 43%|█████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                | 13/30 [00:01<00:02,  7.32it/s]2024-06-20 10:52:44,010 | pinder.core.utils.cloud:368 | INFO : Gsutil process_many=download_to_filename, threads=2, items=2\n",
      "2024-06-20 10:52:44,105 | pinder.core.utils.cloud.process_many:27 | ERROR : runtime failed:      0.10s\n",
      "2024-06-20 10:52:44,106 | pinder.core.loader.loader:35 | ERROR : Requested storage blob <2024-02/pdbs/af__Q68T42.pdb> does not exist! Verify that the provided GCS path points to a valid file!\n",
      "100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:03<00:00,  9.55it/s]\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "{'7zj1__B1_P55265--7zj1__A1_P55265': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7zj1__B1_P55265-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7zj1__A1_P55265-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/2mdr__A1_P55265.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/2mdr__A1_P55265.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P55265.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P55265.pdb')},\n",
       " '7zjc__A1_P0DV83--7zjc__A2_P0DV83': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7zjc__A1_P0DV83-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7zjc__A2_P0DV83-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7qdv__A1_P0DV83.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7qdv__A1_P0DV83.pdb'),\n",
       "  'pred_receptor': None,\n",
       "  'pred_ligand': None},\n",
       " '7ztw__A1_Q66578--7ztw__B1_Q66578': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7ztw__A1_Q66578-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7ztw__B1_Q66578-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7zu3__A1_Q66578.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7zu4__A1_Q66578.pdb'),\n",
       "  'pred_receptor': None,\n",
       "  'pred_ligand': None},\n",
       " '8ard__A1_Q64331--8ard__A2_Q64331': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8ard__A1_Q64331-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8ard__A2_Q64331-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/2ld3__A1_Q64331.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/2ld3__A1_Q64331.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q64331.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q64331.pdb')},\n",
       " '7wbt__A1_Q288C4--7wbt__B1_Q288C4': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7wbt__A1_Q288C4-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7wbt__B1_Q288C4-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7wbu__A1_Q288C4.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7wbu__A1_Q288C4.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q288C4.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q288C4.pdb')},\n",
       " '7z7o__A1_A0A1S4NYF2--7z7o__C1_A0A1S4NYF2': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7z7o__A1_A0A1S4NYF2-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7z7o__C1_A0A1S4NYF2-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7z7p__A1_A0A1S4NYF2.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7z7p__A1_A0A1S4NYF2.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__A0A1S4NYF2.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__A0A1S4NYF2.pdb')},\n",
       " '8pte__A1_P00698--8pte__A2_P00698': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8pte__A1_P00698-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8pte__A2_P00698-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/2q0m__A1_P00698.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/2q0m__A1_P00698.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P00698.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P00698.pdb')},\n",
       " '7yka__B1_Q9Y3D6--7yka__A1_Q9Y3D6': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7yka__B1_Q9Y3D6-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7yka__A1_Q9Y3D6-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/1nzn__A1_Q9Y3D6.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/1nzn__A1_Q9Y3D6.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q9Y3D6.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q9Y3D6.pdb')},\n",
       " '7ykv__B1_Q58241--7ykv__A1_Q58241': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7ykv__B1_Q58241-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7ykv__A1_Q58241-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/6tvv__A1_Q58241.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/6tvv__A1_Q58241.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q58241.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q58241.pdb')},\n",
       " '8a60__A1_P06971--8a60__B1_Q38162': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8a60__A1_P06971-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8a60__B1_Q38162-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/2fcp__A1_P06971.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7qjf__A1_Q38162.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P06971.pdb'),\n",
       "  'pred_ligand': None},\n",
       " '7t5y__A1_P0A7E1--7t5y__B1_P0A7E1': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7t5y__A1_P0A7E1-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7t5y__B1_P0A7E1-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/1f76__A1_P0A7E1.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/1f76__A1_P0A7E1.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P0A7E1.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P0A7E1.pdb')},\n",
       " '8oru__A1_O93732--8oru__B1_O93732': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8oru__A1_O93732-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8oru__B1_O93732-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/8ork__A1_O93732.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/8ork__A1_O93732.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__O93732.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__O93732.pdb')},\n",
       " '7z6m__A1_A0A0H3LM39--7z6m__A2_A0A0H3LM39': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7z6m__A1_A0A0H3LM39-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7z6m__A2_A0A0H3LM39-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/5tsb__A1_A0A0H3LM39.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/5tsb__A1_A0A0H3LM39.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__A0A0H3LM39.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__A0A0H3LM39.pdb')},\n",
       " '7wwo__B1_Q5SH57--7wwo__A1_Q5SH57': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7wwo__B1_Q5SH57-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7wwo__A1_Q5SH57-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7wrk__A1_Q5SH57.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7wrk__A1_Q5SH57.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q5SH57.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q5SH57.pdb')},\n",
       " '8d0m__A1_P28907--8d0m__A2_P28907': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8d0m__A1_P28907-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8d0m__A2_P28907-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/8p8c__A1_P28907.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/8p8c__A1_P28907.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P28907.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P28907.pdb')},\n",
       " '8avu__A1_Q8GPI4--8avu__A2_Q8GPI4': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8avu__A1_Q8GPI4-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8avu__A2_Q8GPI4-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/8avs__A1_Q8GPI4.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/8avs__A1_Q8GPI4.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q8GPI4.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q8GPI4.pdb')},\n",
       " '8i2e__A1_O34841--8i2e__B1_P54421': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8i2e__A1_O34841-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8i2e__B1_P54421-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/2rsx__A1_O34841.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/8i2d__A1_P54421.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__O34841.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P54421.pdb')},\n",
       " '8aeu__A1_Q00987--8aeu__A2_Q00987': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8aeu__A1_Q00987-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8aeu__A2_Q00987-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/6kzu__A1_Q00987.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/6kzu__A1_Q00987.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q00987.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q00987.pdb')},\n",
       " '7vso__A1_P02945--7vso__A2_P02945': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7vso__A1_P02945-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7vso__A2_P02945-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/5b34__A1_P02945.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/5b34__A1_P02945.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P02945.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P02945.pdb')},\n",
       " '7yuj__B1_Q9BYM8--7yuj__A1_Q9BYM8': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7yuj__B1_Q9BYM8-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7yuj__A1_Q9BYM8-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/8bvl__A1_Q9BYM8.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/8bvl__A1_Q9BYM8.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q9BYM8.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q9BYM8.pdb')},\n",
       " '8pvm__A1_P29166--8pvm__B1_P29166': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8pvm__A1_P29166-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8pvm__B1_P29166-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/8aio__A1_P29166.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/5byq__A1_P29166.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P29166.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P29166.pdb')},\n",
       " '7yo8__A1_P60520--7yo8__A2_P60520': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7yo8__A1_P60520-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7yo8__A2_P60520-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7lk3__A1_P60520.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7lk3__A1_P60520.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P60520.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P60520.pdb')},\n",
       " '7y51__A1_Q8RBF4--7y51__A2_Q8RBF4': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7y51__A1_Q8RBF4-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7y51__A2_Q8RBF4-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7fbw__A1_Q8RBF4.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7fbw__A1_Q8RBF4.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q8RBF4.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q8RBF4.pdb')},\n",
       " '7tvh__B1_Q9I2Q1--7tvh__A1_Q9I2Q1': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7tvh__B1_Q9I2Q1-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7tvh__A1_Q9I2Q1-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/4fgd__A1_Q9I2Q1.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/4f4m__A1_Q9I2Q1.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q9I2Q1.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q9I2Q1.pdb')},\n",
       " '8bwv__D2_A0A482M8M0--8bwv__A1_A0A482M8M0': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8bwv__D2_A0A482M8M0-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/8bwv__A1_A0A482M8M0-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/8bbz__A1_A0A482M8M0.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/8bhu__A1_A0A482M8M0.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__A0A482M8M0.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__A0A482M8M0.pdb')},\n",
       " '7t91__A1_P08151--7t91__B1_P08151': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7t91__A1_P08151-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7t91__B1_P08151-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/2gli__C1_P08151.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/2gli__C1_P08151.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P08151.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__P08151.pdb')},\n",
       " '7zoo__B1_A0A979GQH9--7zoo__A1_A0A979GQH9': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7zoo__B1_A0A979GQH9-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7zoo__A1_A0A979GQH9-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7zoh__A1_A0A979GQH9.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7zoh__A1_A0A979GQH9.pdb'),\n",
       "  'pred_receptor': None,\n",
       "  'pred_ligand': None},\n",
       " '7x4b__A1_A0A2D0TCG3--7x4b__B1_A0A2D0TCG3': {'holo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7x4b__A1_A0A2D0TCG3-R.pdb'),\n",
       "  'holo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/test_set_pdbs/7x4b__B1_A0A2D0TCG3-L.pdb'),\n",
       "  'apo_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7x31__A1_A0A2D0TCG3.pdb'),\n",
       "  'apo_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/7x31__A1_A0A2D0TCG3.pdb'),\n",
       "  'pred_receptor': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__A0A2D0TCG3.pdb'),\n",
       "  'pred_ligand': PosixPath('/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__A0A2D0TCG3.pdb')}}"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "local_paths = {}\n",
    "for system in get_systems(list(af2_apo.id)):\n",
    "    local_paths[system.entry.id] = system.filepaths\n",
    "local_paths    "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4a5dfd80-5427-4bd9-8433-fae50870f72a",
   "metadata": {},
   "source": [
    "### Pinder filters"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "57c615bb-711c-49c4-822f-750f3349c715",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<generator object <genexpr> at 0x1c91e9970>"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from pinder.core.loader import filters\n",
    "\n",
    "pinder_id = \"1df0__A1_Q07009--1df0__B1_Q64537\"\n",
    "dimer = PinderSystem(entry=pinder_id)\n",
    "\n",
    "base_filters = [\n",
    "    filters.FilterByMissingHolo(),\n",
    "    filters.FilterSubByContacts(min_contacts=5, radius=10.0, calpha_only=True),\n",
    "    filters.FilterByHoloElongation(max_var_contribution=0.92),\n",
    "    filters.FilterDetachedHolo(radius=12, max_components=2),\n",
    "]\n",
    "sub_filters = [\n",
    "    filters.FilterSubByAtomTypes(min_atom_types=4),\n",
    "    filters.FilterByHoloOverlap(min_overlap=5),\n",
    "    filters.FilterByHoloSeqIdentity(min_sequence_identity=0.8),\n",
    "    filters.FilterSubLengths(min_length=0, max_length=1000),\n",
    "    filters.FilterSubRmsds(rmsd_cutoff=7.5),\n",
    "    filters.FilterByElongation(max_var_contribution=0.92),\n",
    "    filters.FilterDetachedSub(radius=12, max_components=2),\n",
    "]\n",
    "dimers = [dimer]\n",
    "for sub_filter in sub_filters:\n",
    "    dimers = (sub_filter(dimer) for dimer in dimers)\n",
    "\n",
    "for base_filter in base_filters:\n",
    "    dimers = (dimer for dimer in dimers if base_filter(dimer))\n",
    "\n",
    "dimers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "22ed5dad-f294-4fc2-8792-39bde4c885d6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "PinderSystem(\n",
       "entry = IndexEntry(\n",
       "    (\n",
       "        'split',\n",
       "        'invalid',\n",
       "    ),\n",
       "    (\n",
       "        'id',\n",
       "        '1df0__A1_Q07009--1df0__B1_Q64537',\n",
       "    ),\n",
       "    (\n",
       "        'pdb_id',\n",
       "        '1df0',\n",
       "    ),\n",
       "    (\n",
       "        'cluster_id',\n",
       "        'cluster_1030_1030',\n",
       "    ),\n",
       "    (\n",
       "        'cluster_id_R',\n",
       "        'cluster_1030',\n",
       "    ),\n",
       "    (\n",
       "        'cluster_id_L',\n",
       "        'cluster_1030',\n",
       "    ),\n",
       "    (\n",
       "        'pinder_s',\n",
       "        False,\n",
       "    ),\n",
       "    (\n",
       "        'pinder_xl',\n",
       "        False,\n",
       "    ),\n",
       "    (\n",
       "        'pinder_af2',\n",
       "        False,\n",
       "    ),\n",
       "    (\n",
       "        'uniprot_R',\n",
       "        'Q07009',\n",
       "    ),\n",
       "    (\n",
       "        'uniprot_L',\n",
       "        'Q64537',\n",
       "    ),\n",
       "    (\n",
       "        'holo_R_pdb',\n",
       "        '1df0__A1_Q07009-R.pdb',\n",
       "    ),\n",
       "    (\n",
       "        'holo_L_pdb',\n",
       "        '1df0__B1_Q64537-L.pdb',\n",
       "    ),\n",
       "    (\n",
       "        'predicted_R_pdb',\n",
       "        'af__Q07009.pdb',\n",
       "    ),\n",
       "    (\n",
       "        'predicted_L_pdb',\n",
       "        'af__Q64537.pdb',\n",
       "    ),\n",
       "    (\n",
       "        'apo_R_pdb',\n",
       "        '',\n",
       "    ),\n",
       "    (\n",
       "        'apo_L_pdb',\n",
       "        '',\n",
       "    ),\n",
       "    (\n",
       "        'apo_R_pdbs',\n",
       "        '',\n",
       "    ),\n",
       "    (\n",
       "        'apo_L_pdbs',\n",
       "        '',\n",
       "    ),\n",
       "    (\n",
       "        'holo_R',\n",
       "        True,\n",
       "    ),\n",
       "    (\n",
       "        'holo_L',\n",
       "        True,\n",
       "    ),\n",
       "    (\n",
       "        'predicted_R',\n",
       "        True,\n",
       "    ),\n",
       "    (\n",
       "        'predicted_L',\n",
       "        True,\n",
       "    ),\n",
       "    (\n",
       "        'apo_R',\n",
       "        False,\n",
       "    ),\n",
       "    (\n",
       "        'apo_L',\n",
       "        False,\n",
       "    ),\n",
       "    (\n",
       "        'apo_R_quality',\n",
       "        '',\n",
       "    ),\n",
       "    (\n",
       "        'apo_L_quality',\n",
       "        '',\n",
       "    ),\n",
       "    (\n",
       "        'chain1_neff',\n",
       "        492.25,\n",
       "    ),\n",
       "    (\n",
       "        'chain2_neff',\n",
       "        528.0,\n",
       "    ),\n",
       "    (\n",
       "        'chain_R',\n",
       "        'A1',\n",
       "    ),\n",
       "    (\n",
       "        'chain_L',\n",
       "        'B1',\n",
       "    ),\n",
       "    (\n",
       "        'contains_antibody',\n",
       "        False,\n",
       "    ),\n",
       "    (\n",
       "        'contains_antigen',\n",
       "        False,\n",
       "    ),\n",
       "    (\n",
       "        'contains_enzyme',\n",
       "        True,\n",
       "    ),\n",
       ")\n",
       "native=Structure(\n",
       "    filepath=/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/1df0__A1_Q07009--1df0__B1_Q64537.pdb,\n",
       "    uniprot_map=None,\n",
       "    pinder_id='1df0__A1_Q07009--1df0__B1_Q64537',\n",
       "    atom_array=<class 'biotite.structure.AtomArray'> with shape (6391,),\n",
       ")\n",
       "holo_receptor=Structure(\n",
       "    filepath=/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/1df0__A1_Q07009-R.pdb,\n",
       "    uniprot_map=/Users/danielkovtun/.local/share/pinder/2024-02/mappings/1df0__A1_Q07009-R.parquet,\n",
       "    pinder_id='1df0__A1_Q07009-R',\n",
       "    atom_array=<class 'biotite.structure.AtomArray'> with shape (4964,),\n",
       ")\n",
       "holo_ligand=Structure(\n",
       "    filepath=/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/1df0__B1_Q64537-L.pdb,\n",
       "    uniprot_map=/Users/danielkovtun/.local/share/pinder/2024-02/mappings/1df0__B1_Q64537-L.parquet,\n",
       "    pinder_id='1df0__B1_Q64537-L',\n",
       "    atom_array=<class 'biotite.structure.AtomArray'> with shape (1427,),\n",
       ")\n",
       "apo_receptor=None\n",
       "apo_ligand=None\n",
       "pred_receptor=Structure(\n",
       "    filepath=/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q07009.pdb,\n",
       "    uniprot_map=None,\n",
       "    pinder_id='af__Q07009',\n",
       "    atom_array=<class 'biotite.structure.AtomArray'> with shape (5631,),\n",
       ")\n",
       "pred_ligand=Structure(\n",
       "    filepath=/Users/danielkovtun/.local/share/pinder/2024-02/pdbs/af__Q64537.pdb,\n",
       "    uniprot_map=None,\n",
       "    pinder_id='af__Q64537',\n",
       "    atom_array=<class 'biotite.structure.AtomArray'> with shape (2006,),\n",
       ")\n",
       ")"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "list(dimers)[0]"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "pinder",
   "language": "python",
   "name": "pinder"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.18"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
